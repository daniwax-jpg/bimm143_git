---
title: "Class 05: Data Visualization with GGPlot"
author: "Dani Weatherwax (PID:A17856408)"
format: pdf
---

Today we are exploring the **ggplot** package and how to make nice figures in R. 

There are lots of ways to make figures and plots in R. These include:

- So called "base" R
-and add on packages like **ggplot**

Here is a simple "base" R plot

```{r}
head(cars)
```

We can simply pass this to the `plot()` function. 

```{r}
plot(cars)
```

> Key-point Base R is quick but not so nice looking in some folks' eyes.

```{r}
head(cars)
hist(cars$dist, )
```


Let's see how we can plot this with **ggplot2**

1st I need to install this add-on package. For this we use the `install.packages()` function **in the console, not our report**

2nd, we need to load the package with the `library()` function every time we want to use it. 

Every ggplot is composed of at least 3 layers:

-**data**- a data.frame with the things you want to plot
- aesthetics **aes()** that maps the columns of data to your plot features (i.e. aesthetics)
- geoms like **geom_point()** that show how the plot appears
```{r}
library(ggplot2)
ggplot(cars) +
  aes(x=speed, y=dist) +
  geom_point()
```



For simple "canned" graphs base R is quicker and more concise but as things get more custom and elaborate then ggplot wins out...

Let's add more layers to our ggplot (a line showing relationship between x and y)

Add a title
Add custom axis labels "Speed (mph)" and "Distance (Feet)"

```{r}
library(ggplot2)
ggplot(cars) +
  aes(x=speed, y=dist) +
  geom_point() +
geom_smooth(method="lm", se=FALSE) +
labs(title = "Plot of Speed vs Stopping Distance",
     x= "Speed (mph)",
     y= "Distance (Ft)") +
  theme_bw()
```

## Going further

Read some gene expression data 
```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```

>Q1. How many genes are in this dataset?

```{r}
nrow(genes)
```
```{r}
ncol(genes)
```

>Q2. How many "Up"regulated genes are there?

```{r}
sum( genes$State== "up" )
```


A useful function for counting up occurrences of things in a vector is the `table()` function.

```{r}
table( genes$State)
```

```{r}
p <- ggplot(genes) +
  aes(x= Condition1, y= Condition2, col=State) +
  geom_point()
p + scale_colour_manual(values=c("blue","gray","red")) +
    labs(title="Gene Expresion Changes Upon Drug Treatment",
         x="Control (no drug) ",
         y="Drug Treatment")
```

## More Plotting

Read in the gapminder dataset
```{r}
# File location online
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
```

Let's have a peek at the data:

```{r}
head(gapminder, 3)
```

How many countries in this dataset?
```{r}
length(table(gapminder$country))
unique(gapminder$continent)
```
```{r}
ggplot(gapminder) +
aes(gdpPercap, lifeExp, col=continent, label= country) +
geom_point()
```


```{r}
ggplot(gapminder) +
aes(gdpPercap, lifeExp, col=continent, label= country) +
geom_point() +
  facet_wrap(~continent)
```

I can use the **ggrepl** package to make more sensible labels here. 

I want a separate panel per continent.

ggplot2 offers several advantages over base R plotting:
Layered Grammar: ggplot2 uses a consistent, layered approach for building plots, making it easier to add or modify elements (data, aesthetics, geoms, themes) step by step 


Publication Quality: ggplot2 produces attractive, publication-ready graphics with sensible defaults, reducing the need for manual tweaking 

Declarative Syntax: You specify what you want to show, not how to draw it, making code more readable and maintainable 

Customization: It is easier to customize and extend plots, especially for complex visualizations, compared to base R which can be fiddly and time-consuming 

Data Mapping: ggplot2 directly maps data columns to visual features (aesthetics), streamlining the process for multivariate and grouped data 

Reproducibility: ggplot2 code is modular and scriptable, making it simple to reproduce and update figures 

Base R is faster for quick, simple plots, but ggplot2 excels for complex, beautiful, and reproducible graphics 

```{r}
geom_col()
```

